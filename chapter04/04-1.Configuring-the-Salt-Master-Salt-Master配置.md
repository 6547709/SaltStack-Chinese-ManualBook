# Configuring the Salt Master - Salt Master配置

Salt非常简单且易于配置，Salt系统的两个组件各自具有相应的配置文件。 salt-master通过master配置文件配置，salt-minion通过minion配置文件配置。*可以参考[master配置文件示例](https://docs.saltstack.com/en/latest/ref/configuration/examples.html#configuration-examples-master)*

Salt Master的配置文件默认位于/etc/salt/master。 一个值得注意的例外是FreeBSD，配置文件位于/usr/local/etc/salt。

Salt Master可用的配置参数如下所示：

+ [PRIMARY-MASTER-CONFIGURATION-基础配置参数](#primary-master-configuration-基础配置参数)
    - [INTERFACE](#INTERFACE)
    - [IPV6](#IPV6)
    - [PUBLISH_PORT](#PUBLISH_PORT)
    - [MASTER_ID](#MASTER_ID)
    - [USER](#USER)
    - [ENABLE_SSH_MINIONS](#ENABLE_SSH_MINIONS)
    - [RET_PORT](#RET_PORT)

# PRIMARY-MASTER-CONFIGURATION-基础配置参数

## INTERFACE
Default: 0.0.0.0 (all interfaces)

服务将要绑定的本地网络接口，必须是IP地址。
``` yaml
interface: 192.168.0.1
```

## IPV6
Default: False

master是否侦听IPv6连接。 如果将此值设置为True，则还必须调整网络接口选项（例如：interface：'::'）
``` yaml
ipv6: True
```

## PUBLISH_PORT
Default: 4505

设置消息发布接口使用的网络端口。
``` yaml
publish_port: 4505
```

## MASTER_ID
Default: None

在发布作业中传递给minions的master id。 这用于MultiSyndics将作业返回给正确的发出请求的master服务器。
``` yaml
master_id: MasterOfMaster
```
*注意：如果还使用到了syndic服务，则这必须与配置syndic的字符串相同。*

## USER
Default: root

用来运行salt master进程的系统用户。
``` yaml
user: root
```

## ENABLE_SSH_MINIONS
Default: False

告诉salt-master启动一个SSHClient的新进程，然后返回salt命令的数据以将其打印出来。
``` yaml
enable_ssh_minions: True
```
*注：跨minions通信仍然是不可能的。 Salt mine和publish.publish在minion类型之间不起作用。*

## RET_PORT
Default: 4506

数据返回服务使用的端口，这是Salt用来接收执行返回数据和命令执行数据的服务。
``` yaml
ret_port: 4506
```

## PIDFILE
Default: /var/run/salt-master.pid

指定master服务pidfile的位置。
``` yaml
pidfile: /var/run/salt-master.pid
```

## ROOT_DIR
Default: /

要运行的系统根目录，更改此项以使Salt从可选的根目录运行。
``` yaml
root_dir: /
```

## CONF_FILE
Default: /etc/salt/master

master服务配置文件的存放位置
``` yaml
conf_file: /etc/salt/master
```

## PKI_DIR
Default: /etc/salt/pki/master

存放pki密钥的目录。
``` yaml
pki_dir: /etc/salt/pki/master
```

## EXTENSION_MODULES
*Changed in version 2016.3.0:
已改变此目录的默认位置。 在此版本之前，该位置是Salt cachedir中的名为extmods的目录（在大多数平台上，/var/cache/salt/extmods）。 它已被移动到master cachedir（在大多数平台上是，/var/cache/salt/master/extmods）。*

自定义模块的目录。 此目录可以包含Salt的每个模块类型的子目录，例如runners，output，wheel，modules，states，returners，engines，utils等。此路径附加到root_dir下面。
``` yaml
extension_modules: /root/salt_extmods
```

## EXTMOD_WHITELIST/EXTMOD_BLACKLIST
New in version 2017.7.0.

通过使用此字典，可以限制使用saltutil.sync_*同步到master的extmod缓存的模块。 如果没有设置为特定类型，则是接受所有模块。 要阻止特定类型的所有模块，请将空白列表列入白名单。
``` yaml
extmod_whitelist:
  modules:
    - custom_module
  engines:
    - custom_engine
  pillars: []

extmod_blacklist:
  modules:
    - specific_module
```
可使用的模块选项有：
- modules
- states
- grains
- renderers
- returners
- output
- proxy
- runners
- wheel
- engines
- queues
- pillar
- utils
- sdb
- cache
- clouds
- tops
- roster
- tokens

## MODULE_DIRS
Default: []

与extension_modules类似，但是用于搜索Salt模块的额外目录列表。
``` yaml
module_dirs:
  - /var/cache/salt/minion/extmods
```

## CACHEDIR
Default: /var/cache/salt/master

用于存储缓存信息的位置，尤其是执行的salt命令的作业信息。

此目录可能包含敏感数据，因此应受到小心保护。
``` yaml
cachedir: /var/cache/salt/master
```

## VERIFY_ENV
Default: True

在启动时验证并设置配置目录的权限。
``` yaml
verify_env: True
```

## KEEP_JOBS
Default: 24

设置保留旧作业信息的小时数。 请注意，将此选项设置为0会禁用缓存清理程序。
``` yaml
keep_jobs: 24
```

## GATHER_JOB_TIMEOUT
*New in version 2014.7.0.*

Default: 24

客户端请求有关正在运行的作业的信息时等待的秒数。
``` yaml
gather_job_timeout: 10
```

## TIMEOUT
Default: 5

设置salt命令和api的默认超时。
